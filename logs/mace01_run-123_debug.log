2025-09-08 16:41:13.866 DEBUG: Popen(['git', 'version'], cwd=/work/home/onescience2025/yuxiaodong/onescience-main, stdin=None, shell=False, universal_newlines=False)
2025-09-08 16:41:13.866 DEBUG: Popen(['git', 'version'], cwd=/work/home/onescience2025/yuxiaodong/onescience-main, stdin=None, shell=False, universal_newlines=False)
2025-09-08 16:41:13.866 DEBUG: Popen(['git', 'version'], cwd=/work/home/onescience2025/yuxiaodong/onescience-main, stdin=None, shell=False, universal_newlines=False)
2025-09-08 16:41:13.874 DEBUG: Popen(['git', 'version'], cwd=/work/home/onescience2025/yuxiaodong/onescience-main, stdin=None, shell=False, universal_newlines=False)
2025-09-08 16:41:13.874 DEBUG: Popen(['git', 'version'], cwd=/work/home/onescience2025/yuxiaodong/onescience-main, stdin=None, shell=False, universal_newlines=False)
2025-09-08 16:41:13.874 DEBUG: Popen(['git', 'version'], cwd=/work/home/onescience2025/yuxiaodong/onescience-main, stdin=None, shell=False, universal_newlines=False)
2025-09-08 16:41:13.879 DEBUG: sys.platform='linux', git_executable='git'
2025-09-08 16:41:13.880 DEBUG: sys.platform='linux', git_executable='git'
2025-09-08 16:41:13.880 DEBUG: sys.platform='linux', git_executable='git'
2025-09-08 16:41:14.568 INFO: ===========VERIFYING SETTINGS===========
2025-09-08 16:41:14.569 INFO: Process group initialized: True
2025-09-08 16:41:14.569 INFO: Processes: 8
2025-09-08 16:41:14.569 INFO: MACE version: 0.3.13
2025-09-08 16:41:14.570 DEBUG: Configuration: Namespace(name='mace01', seed=123, work_dir='.', log_dir='./logs', model_dir='.', checkpoints_dir='./checkpoints', results_dir='./results', downloads_dir='./downloads', device='cuda', default_dtype='float64', distributed=True, log_level='INFO', plot=True, plot_frequency=0, error_table='PerAtomRMSE', model='MACE', r_max=4.0, radial_type='bessel', num_radial_basis=8, num_cutoff_basis=5, pair_repulsion=False, distance_transform='None', interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', radial_MLP='[64, 64, 64]', hidden_irreps=32x0e, num_channels=32, max_L=0, gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, compute_stress=False, compute_forces=True, train_file='/work/home/onescience2025/yuxiaodong/mace/chemistry/data/solvent_xtb_train_200.xyz', valid_file=None, valid_fraction=0.1, test_file='/work/home/onescience2025/yuxiaodong/mace/chemistry/data/solvent_xtb_test.xyz', test_dir=None, multi_processed_test=False, num_workers=8, pin_memory=True, atomic_numbers=None, mean=None, std=None, statistics_file=None, E0s=None, foundation_filter_elements=True, heads=None, multiheads_finetuning=True, foundation_head=None, weight_pt_head=1.0, num_samples_pt=10000, force_mh_ft_lr=False, subselect_pt='random', filter_type_pt='none', pt_train_file=None, pt_valid_file=None, foundation_model_elements=False, keep_isolated_atoms=False, energy_key='energy_xtb', forces_key='forces_xtb', virials_key='REF_virials', stress_key='REF_stress', dipole_key='dipole', head_key='head', charges_key='REF_charges', skip_evaluate_heads='pt_head', loss='weighted', forces_weight=100.0, swa_forces_weight=100.0, energy_weight=1.0, swa_energy_weight=1000.0, virials_weight=1.0, swa_virials_weight=10.0, stress_weight=1.0, swa_stress_weight=10.0, dipole_weight=1.0, swa_dipole_weight=1.0, config_type_weights='{"Default":1.0}', huber_delta=0.01, optimizer='adam', beta=0.9, batch_size=10, valid_batch_size=10, lr=0.01, swa_lr=0.001, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_patience=50, lr_scheduler_gamma=0.9993, swa=True, start_swa=75, lbfgs=False, ema=False, ema_decay=0.99, max_num_epochs=100, patience=2048, foundation_model=None, foundation_model_readout=True, eval_interval=1, keep_checkpoints=False, save_all_checkpoints=False, restart_latest=False, save_cpu=False, clip_grad=10.0, dry_run=False, enable_cueq=False, wandb=False, wandb_dir=None, wandb_project='', wandb_entity='', wandb_name='', wandb_log_hypers=['num_channels', 'max_L', 'correlation', 'lr', 'swa_lr', 'weight_decay', 'batch_size', 'max_num_epochs', 'start_swa', 'energy_weight', 'forces_weight'], key_specification=KeySpecification(info_keys={'energy': 'energy_xtb', 'stress': 'REF_stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head'}, arrays_keys={'forces': 'forces_xtb', 'charges': 'REF_charges'}))
2025-09-08 16:41:14.570 INFO: CUDA version: None, CUDA device: 0
2025-09-08 16:41:14.613 DEBUG: Popen(['git', 'version'], cwd=/work/home/onescience2025/yuxiaodong/onescience-main, stdin=None, shell=False, universal_newlines=False)
2025-09-08 16:41:14.618 DEBUG: Popen(['git', 'version'], cwd=/work/home/onescience2025/yuxiaodong/onescience-main, stdin=None, shell=False, universal_newlines=False)
2025-09-08 16:41:14.621 DEBUG: sys.platform='linux', git_executable='git'
2025-09-08 16:41:14.623 DEBUG: Error accessing Git repository: /work/home/onescience2025/yuxiaodong/onescience-main
2025-09-08 16:41:14.623 INFO: ===========LOADING INPUT DATA===========
2025-09-08 16:41:14.623 INFO: Using heads: ['Default']
2025-09-08 16:41:14.623 INFO: Using the key specifications to parse data:
2025-09-08 16:41:14.624 INFO: Default: KeySpecification(info_keys={'energy': 'energy_xtb', 'stress': 'REF_stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head'}, arrays_keys={'forces': 'forces_xtb', 'charges': 'REF_charges'})
2025-09-08 16:41:14.624 INFO: =============    Processing head Default     ===========
2025-09-08 16:41:14.624 DEBUG: Loading training file: /work/home/onescience2025/yuxiaodong/mace/chemistry/data/solvent_xtb_train_200.xyz
2025-09-08 16:41:14.722 DEBUG: Popen(['git', 'version'], cwd=/work/home/onescience2025/yuxiaodong/onescience-main, stdin=None, shell=False, universal_newlines=False)
2025-09-08 16:41:14.722 DEBUG: Popen(['git', 'version'], cwd=/work/home/onescience2025/yuxiaodong/onescience-main, stdin=None, shell=False, universal_newlines=False)
2025-09-08 16:41:14.722 DEBUG: Popen(['git', 'version'], cwd=/work/home/onescience2025/yuxiaodong/onescience-main, stdin=None, shell=False, universal_newlines=False)
2025-09-08 16:41:14.722 DEBUG: Popen(['git', 'version'], cwd=/work/home/onescience2025/yuxiaodong/onescience-main, stdin=None, shell=False, universal_newlines=False)
2025-09-08 16:41:14.728 INFO: Using isolated atom energies from training file
2025-09-08 16:41:14.740 INFO: Training set 1/1 [energy: 200, stress: 0, virials: 0, dipole components: 0, head: 200, forces: 200, charges: 0]
2025-09-08 16:41:14.741 INFO: Total Training set [energy: 200, stress: 0, virials: 0, dipole components: 0, head: 200, forces: 200, charges: 0]
2025-09-08 16:41:14.741 INFO: No validation set provided, splitting training data instead.
2025-09-08 16:41:14.742 INFO: Using random 10% of training set for validation with indices saved in: ./valid_indices_123.txt
2025-09-08 16:41:14.742 DEBUG: Popen(['git', 'version'], cwd=/work/home/onescience2025/yuxiaodong/onescience-main, stdin=None, shell=False, universal_newlines=False)
2025-09-08 16:41:14.741 DEBUG: Popen(['git', 'version'], cwd=/work/home/onescience2025/yuxiaodong/onescience-main, stdin=None, shell=False, universal_newlines=False)
2025-09-08 16:41:14.744 INFO: Random Split Training set [energy: 180, stress: 0, virials: 0, dipole components: 0, head: 180, forces: 180, charges: 0]
2025-09-08 16:41:14.742 DEBUG: Popen(['git', 'version'], cwd=/work/home/onescience2025/yuxiaodong/onescience-main, stdin=None, shell=False, universal_newlines=False)
2025-09-08 16:41:14.747 INFO: Random Split Validation set [energy: 20, stress: 0, virials: 0, dipole components: 0, head: 20, forces: 20, charges: 0]
2025-09-08 16:41:14.742 DEBUG: Popen(['git', 'version'], cwd=/work/home/onescience2025/yuxiaodong/onescience-main, stdin=None, shell=False, universal_newlines=False)
2025-09-08 16:41:14.748 DEBUG: sys.platform='linux', git_executable='git'
2025-09-08 16:41:14.749 DEBUG: sys.platform='linux', git_executable='git'
2025-09-08 16:41:14.752 DEBUG: sys.platform='linux', git_executable='git'
2025-09-08 16:41:14.755 DEBUG: sys.platform='linux', git_executable='git'
2025-09-08 16:41:15.180 INFO: Test set 1/1 [energy: 1000, stress: 0, virials: 0, dipole components: 0, head: 1000, forces: 1000, charges: 0]
2025-09-08 16:41:15.190 INFO: Total Test set [energy: 1000, stress: 0, virials: 0, dipole components: 0, head: 1000, forces: 1000, charges: 0]
2025-09-08 16:41:15.190 DEBUG: Element 1 found in 1 file. Using E0: -10.707211 eV
2025-09-08 16:41:15.191 DEBUG: Element 6 found in 1 file. Using E0: -48.847445 eV
2025-09-08 16:41:15.191 DEBUG: Element 8 found in 1 file. Using E0: -102.571173 eV
2025-09-08 16:41:15.191 INFO: Total number of configurations: train=180, valid=20, tests=[Default_Default: 1000],
2025-09-08 16:41:15.192 INFO: Atomic Numbers used: [1, 6, 8]
2025-09-08 16:41:15.193 INFO: Atomic Energies used (z: eV) for head Default: {1: -10.707211383396714, 6: -48.847445262804705, 8: -102.57117256025786}
2025-09-08 16:41:15.193 INFO: Processing datasets for head 'Default'
2025-09-08 16:41:15.287 DEBUG: Successfully loaded dataset from ASE files: ['/work/home/onescience2025/yuxiaodong/mace/chemistry/data/solvent_xtb_train_200.xyz']
2025-09-08 16:41:15.287 INFO: Combining 1 list datasets for head 'Default'
2025-09-08 16:41:15.297 INFO: Head 'Default' training dataset size: 180
2025-09-08 16:41:15.298 INFO: Computing average number of neighbors
2025-09-08 16:41:16.987 INFO: Average number of neighbors: 9.862346247328155
2025-09-08 16:41:16.987 INFO: During training the following quantities will be reported: energy, forces
2025-09-08 16:41:16.988 INFO: ===========MODEL DETAILS===========
2025-09-08 16:41:17.189 INFO: Building model
2025-09-08 16:41:17.189 INFO: Message passing with 32 channels and max_L=0 (32x0e)
2025-09-08 16:41:17.189 INFO: 2 layers, each with correlation order: 3 (body order: 4) and spherical harmonics up to: l=3
2025-09-08 16:41:17.189 INFO: 8 radial and 5 basis functions
2025-09-08 16:41:17.189 INFO: Radial cutoff: 4.0 A (total receptive field for each atom: 8.0 A)
2025-09-08 16:41:17.189 INFO: Distance transform for radial basis functions: None
2025-09-08 16:41:17.189 INFO: Hidden irreps: 32x0e
2025-09-08 16:41:18.827 DEBUG: ScaleShiftMACE(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(3x0e -> 32x0e | 96 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=4.0, num_basis=8, trainable=False)
    (cutoff_fn): PolynomialCutoff(p=5, r_max=4.0)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[[-10.7072, -48.8474, -102.5712]])
  (interactions): ModuleList(
    (0): RealAgnosticInteractionBlock(
      (linear_up): Linear(32x0e -> 32x0e | 1024 weights)
      (conv_tp): TensorProduct(32x0e x 1x0e+1x1o+1x2e+1x3o -> 32x0e+32x1o+32x2e+32x3o | 128 paths | 128 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 128]
      (linear): Linear(32x0e+32x1o+32x2e+32x3o -> 32x0e+32x1o+32x2e+32x3o | 4096 weights)
      (skip_tp): FullyConnectedTensorProduct(32x0e+32x1o+32x2e+32x3o x 3x0e -> 32x0e+32x1o+32x2e+32x3o | 12288 paths | 12288 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(32x0e -> 32x0e | 1024 weights)
      (conv_tp): TensorProduct(32x0e x 1x0e+1x1o+1x2e+1x3o -> 32x0e+32x1o+32x2e+32x3o | 128 paths | 128 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 128]
      (linear): Linear(32x0e+32x1o+32x2e+32x3o -> 32x0e+32x1o+32x2e+32x3o | 4096 weights)
      (skip_tp): FullyConnectedTensorProduct(32x0e x 3x0e -> 32x0e | 3072 paths | 3072 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0-1): 2 x EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 3x4x32 (cuda:0)]
                (1): Parameter containing: [torch.float64 of size 3x1x32 (cuda:0)]
            )
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(32x0e -> 32x0e | 1024 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(32x0e -> 1x0e | 32 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(32x0e -> 16x0e | 512 weights)
      (non_linearity): Activation [x] (16x0e -> 16x0e)
      (linear_2): Linear(16x0e -> 1x0e | 16 weights)
    )
  )
  (scale_shift): ScaleShiftBlock(scale=2.2278, shift=0.0000)
)
2025-09-08 16:41:18.829 INFO: Total number of parameters: 67472
2025-09-08 16:41:18.829 INFO: 
2025-09-08 16:41:18.829 INFO: ===========OPTIMIZER INFORMATION===========
2025-09-08 16:41:18.829 INFO: Using ADAM as parameter optimizer
2025-09-08 16:41:18.829 INFO: Batch size: 10
2025-09-08 16:41:18.830 INFO: Number of gradient updates: 1800
2025-09-08 16:41:18.830 INFO: Learning rate: 0.01, weight decay: 5e-07
2025-09-08 16:41:18.830 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=100.000)
2025-09-08 16:41:18.830 INFO: Stage Two (after 75 epochs) with loss function: WeightedEnergyForcesLoss(energy_weight=1000.000, forces_weight=100.000), with energy weight : 1000.0, forces weight : 100.0 and learning rate : 0.001
2025-09-08 16:41:18.958 INFO: Using gradient clipping with tolerance=10.000
2025-09-08 16:41:18.958 INFO: 
2025-09-08 16:41:18.958 INFO: ===========TRAINING===========
2025-09-08 16:41:18.958 INFO: Started training, reporting errors on validation set
2025-09-08 16:41:18.959 INFO: Loss metrics on validation set
2025-09-08 16:48:21.210 INFO: ===========VERIFYING SETTINGS===========
2025-09-08 16:48:21.212 INFO: Process group initialized: True
2025-09-08 16:48:21.212 INFO: Processes: 8
2025-09-08 16:48:21.213 INFO: MACE version: 0.3.13
2025-09-08 16:48:21.213 DEBUG: Configuration: Namespace(name='mace01', seed=123, work_dir='.', log_dir='./logs', model_dir='.', checkpoints_dir='./checkpoints', results_dir='./results', downloads_dir='./downloads', device='cuda', default_dtype='float64', distributed=True, log_level='INFO', plot=True, plot_frequency=0, error_table='PerAtomRMSE', model='MACE', r_max=4.0, radial_type='bessel', num_radial_basis=8, num_cutoff_basis=5, pair_repulsion=False, distance_transform='None', interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', radial_MLP='[64, 64, 64]', hidden_irreps=32x0e, num_channels=32, max_L=0, gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, compute_stress=False, compute_forces=True, train_file='/work/home/onescience2025/yuxiaodong/mace/chemistry/data/solvent_xtb_train_200.xyz', valid_file=None, valid_fraction=0.1, test_file='/work/home/onescience2025/yuxiaodong/mace/chemistry/data/solvent_xtb_test.xyz', test_dir=None, multi_processed_test=False, num_workers=8, pin_memory=True, atomic_numbers=None, mean=None, std=None, statistics_file=None, E0s=None, foundation_filter_elements=True, heads=None, multiheads_finetuning=True, foundation_head=None, weight_pt_head=1.0, num_samples_pt=10000, force_mh_ft_lr=False, subselect_pt='random', filter_type_pt='none', pt_train_file=None, pt_valid_file=None, foundation_model_elements=False, keep_isolated_atoms=False, energy_key='energy_xtb', forces_key='forces_xtb', virials_key='REF_virials', stress_key='REF_stress', dipole_key='dipole', head_key='head', charges_key='REF_charges', skip_evaluate_heads='pt_head', loss='weighted', forces_weight=100.0, swa_forces_weight=100.0, energy_weight=1.0, swa_energy_weight=1000.0, virials_weight=1.0, swa_virials_weight=10.0, stress_weight=1.0, swa_stress_weight=10.0, dipole_weight=1.0, swa_dipole_weight=1.0, config_type_weights='{"Default":1.0}', huber_delta=0.01, optimizer='adam', beta=0.9, batch_size=10, valid_batch_size=10, lr=0.01, swa_lr=0.001, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_patience=50, lr_scheduler_gamma=0.9993, swa=True, start_swa=75, lbfgs=False, ema=False, ema_decay=0.99, max_num_epochs=100, patience=2048, foundation_model=None, foundation_model_readout=True, eval_interval=1, keep_checkpoints=False, save_all_checkpoints=False, restart_latest=False, save_cpu=False, clip_grad=10.0, dry_run=False, enable_cueq=False, wandb=False, wandb_dir=None, wandb_project='', wandb_entity='', wandb_name='', wandb_log_hypers=['num_channels', 'max_L', 'correlation', 'lr', 'swa_lr', 'weight_decay', 'batch_size', 'max_num_epochs', 'start_swa', 'energy_weight', 'forces_weight'], key_specification=KeySpecification(info_keys={'energy': 'energy_xtb', 'stress': 'REF_stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head'}, arrays_keys={'forces': 'forces_xtb', 'charges': 'REF_charges'}))
2025-09-08 16:48:21.213 INFO: CUDA version: None, CUDA device: 0
2025-09-08 16:48:21.366 DEBUG: Popen(['git', 'version'], cwd=/work/home/onescience2025/yuxiaodong/onescience-main, stdin=None, shell=False, universal_newlines=False)
2025-09-08 16:48:21.366 DEBUG: Popen(['git', 'version'], cwd=/work/home/onescience2025/yuxiaodong/onescience-main, stdin=None, shell=False, universal_newlines=False)
2025-09-08 16:48:21.366 DEBUG: Popen(['git', 'version'], cwd=/work/home/onescience2025/yuxiaodong/onescience-main, stdin=None, shell=False, universal_newlines=False)
2025-09-08 16:48:21.366 DEBUG: Popen(['git', 'version'], cwd=/work/home/onescience2025/yuxiaodong/onescience-main, stdin=None, shell=False, universal_newlines=False)
2025-09-08 16:48:21.366 DEBUG: Popen(['git', 'version'], cwd=/work/home/onescience2025/yuxiaodong/onescience-main, stdin=None, shell=False, universal_newlines=False)
2025-09-08 16:48:21.366 DEBUG: Popen(['git', 'version'], cwd=/work/home/onescience2025/yuxiaodong/onescience-main, stdin=None, shell=False, universal_newlines=False)
2025-09-08 16:48:21.366 DEBUG: Popen(['git', 'version'], cwd=/work/home/onescience2025/yuxiaodong/onescience-main, stdin=None, shell=False, universal_newlines=False)
2025-09-08 16:48:21.366 DEBUG: Popen(['git', 'version'], cwd=/work/home/onescience2025/yuxiaodong/onescience-main, stdin=None, shell=False, universal_newlines=False)
2025-09-08 16:48:21.372 DEBUG: Popen(['git', 'version'], cwd=/work/home/onescience2025/yuxiaodong/onescience-main, stdin=None, shell=False, universal_newlines=False)
2025-09-08 16:48:21.373 DEBUG: Popen(['git', 'version'], cwd=/work/home/onescience2025/yuxiaodong/onescience-main, stdin=None, shell=False, universal_newlines=False)
2025-09-08 16:48:21.373 DEBUG: Popen(['git', 'version'], cwd=/work/home/onescience2025/yuxiaodong/onescience-main, stdin=None, shell=False, universal_newlines=False)
2025-09-08 16:48:21.373 DEBUG: Popen(['git', 'version'], cwd=/work/home/onescience2025/yuxiaodong/onescience-main, stdin=None, shell=False, universal_newlines=False)
2025-09-08 16:48:21.375 DEBUG: Popen(['git', 'version'], cwd=/work/home/onescience2025/yuxiaodong/onescience-main, stdin=None, shell=False, universal_newlines=False)
2025-09-08 16:48:21.375 DEBUG: Popen(['git', 'version'], cwd=/work/home/onescience2025/yuxiaodong/onescience-main, stdin=None, shell=False, universal_newlines=False)
2025-09-08 16:48:21.376 DEBUG: Popen(['git', 'version'], cwd=/work/home/onescience2025/yuxiaodong/onescience-main, stdin=None, shell=False, universal_newlines=False)
2025-09-08 16:48:21.376 DEBUG: Popen(['git', 'version'], cwd=/work/home/onescience2025/yuxiaodong/onescience-main, stdin=None, shell=False, universal_newlines=False)
2025-09-08 16:48:21.379 DEBUG: sys.platform='linux', git_executable='git'
2025-09-08 16:48:21.380 DEBUG: sys.platform='linux', git_executable='git'
2025-09-08 16:48:21.380 DEBUG: sys.platform='linux', git_executable='git'
2025-09-08 16:48:21.380 DEBUG: sys.platform='linux', git_executable='git'
2025-09-08 16:48:21.382 DEBUG: sys.platform='linux', git_executable='git'
2025-09-08 16:48:21.383 DEBUG: Error accessing Git repository: /work/home/onescience2025/yuxiaodong/onescience-main
2025-09-08 16:48:21.382 DEBUG: sys.platform='linux', git_executable='git'
2025-09-08 16:48:21.386 INFO: ===========LOADING INPUT DATA===========
2025-09-08 16:48:21.383 DEBUG: sys.platform='linux', git_executable='git'
2025-09-08 16:48:21.389 INFO: Using heads: ['Default']
2025-09-08 16:48:21.383 DEBUG: sys.platform='linux', git_executable='git'
2025-09-08 16:48:21.392 INFO: Using the key specifications to parse data:
2025-09-08 16:48:21.394 INFO: Default: KeySpecification(info_keys={'energy': 'energy_xtb', 'stress': 'REF_stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head'}, arrays_keys={'forces': 'forces_xtb', 'charges': 'REF_charges'})
2025-09-08 16:48:21.395 INFO: =============    Processing head Default     ===========
2025-09-08 16:48:21.395 DEBUG: Loading training file: /work/home/onescience2025/yuxiaodong/mace/chemistry/data/solvent_xtb_train_200.xyz
2025-09-08 16:48:21.500 INFO: Using isolated atom energies from training file
2025-09-08 16:48:21.509 INFO: Training set 1/1 [energy: 200, stress: 0, virials: 0, dipole components: 0, head: 200, forces: 200, charges: 0]
2025-09-08 16:48:21.511 INFO: Total Training set [energy: 200, stress: 0, virials: 0, dipole components: 0, head: 200, forces: 200, charges: 0]
2025-09-08 16:48:21.511 INFO: No validation set provided, splitting training data instead.
2025-09-08 16:48:21.515 INFO: Using random 10% of training set for validation with indices saved in: ./valid_indices_123.txt
2025-09-08 16:48:21.517 INFO: Random Split Training set [energy: 180, stress: 0, virials: 0, dipole components: 0, head: 180, forces: 180, charges: 0]
2025-09-08 16:48:21.517 INFO: Random Split Validation set [energy: 20, stress: 0, virials: 0, dipole components: 0, head: 20, forces: 20, charges: 0]
2025-09-08 16:48:21.947 INFO: Test set 1/1 [energy: 1000, stress: 0, virials: 0, dipole components: 0, head: 1000, forces: 1000, charges: 0]
2025-09-08 16:48:21.954 INFO: Total Test set [energy: 1000, stress: 0, virials: 0, dipole components: 0, head: 1000, forces: 1000, charges: 0]
2025-09-08 16:48:21.954 DEBUG: Element 1 found in 1 file. Using E0: -10.707211 eV
2025-09-08 16:48:21.954 DEBUG: Element 6 found in 1 file. Using E0: -48.847445 eV
2025-09-08 16:48:21.954 DEBUG: Element 8 found in 1 file. Using E0: -102.571173 eV
2025-09-08 16:48:21.954 INFO: Total number of configurations: train=180, valid=20, tests=[Default_Default: 1000],
2025-09-08 16:48:21.956 INFO: Atomic Numbers used: [1, 6, 8]
2025-09-08 16:48:21.956 INFO: Atomic Energies used (z: eV) for head Default: {1: -10.707211383396714, 6: -48.847445262804705, 8: -102.57117256025786}
2025-09-08 16:48:21.956 INFO: Processing datasets for head 'Default'
2025-09-08 16:48:22.052 DEBUG: Successfully loaded dataset from ASE files: ['/work/home/onescience2025/yuxiaodong/mace/chemistry/data/solvent_xtb_train_200.xyz']
2025-09-08 16:48:22.052 INFO: Combining 1 list datasets for head 'Default'
2025-09-08 16:48:22.063 INFO: Head 'Default' training dataset size: 180
2025-09-08 16:48:22.063 INFO: Computing average number of neighbors
2025-09-08 16:48:23.814 INFO: Average number of neighbors: 9.862346247328155
2025-09-08 16:48:23.814 INFO: During training the following quantities will be reported: energy, forces
2025-09-08 16:48:23.814 INFO: ===========MODEL DETAILS===========
2025-09-08 16:48:24.048 INFO: Building model
2025-09-08 16:48:24.048 INFO: Message passing with 32 channels and max_L=0 (32x0e)
2025-09-08 16:48:24.048 INFO: 2 layers, each with correlation order: 3 (body order: 4) and spherical harmonics up to: l=3
2025-09-08 16:48:24.048 INFO: 8 radial and 5 basis functions
2025-09-08 16:48:24.048 INFO: Radial cutoff: 4.0 A (total receptive field for each atom: 8.0 A)
2025-09-08 16:48:24.049 INFO: Distance transform for radial basis functions: None
2025-09-08 16:48:24.049 INFO: Hidden irreps: 32x0e
2025-09-08 16:48:25.666 DEBUG: ScaleShiftMACE(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(3x0e -> 32x0e | 96 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=4.0, num_basis=8, trainable=False)
    (cutoff_fn): PolynomialCutoff(p=5, r_max=4.0)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[[-10.7072, -48.8474, -102.5712]])
  (interactions): ModuleList(
    (0): RealAgnosticInteractionBlock(
      (linear_up): Linear(32x0e -> 32x0e | 1024 weights)
      (conv_tp): TensorProduct(32x0e x 1x0e+1x1o+1x2e+1x3o -> 32x0e+32x1o+32x2e+32x3o | 128 paths | 128 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 128]
      (linear): Linear(32x0e+32x1o+32x2e+32x3o -> 32x0e+32x1o+32x2e+32x3o | 4096 weights)
      (skip_tp): FullyConnectedTensorProduct(32x0e+32x1o+32x2e+32x3o x 3x0e -> 32x0e+32x1o+32x2e+32x3o | 12288 paths | 12288 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(32x0e -> 32x0e | 1024 weights)
      (conv_tp): TensorProduct(32x0e x 1x0e+1x1o+1x2e+1x3o -> 32x0e+32x1o+32x2e+32x3o | 128 paths | 128 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 128]
      (linear): Linear(32x0e+32x1o+32x2e+32x3o -> 32x0e+32x1o+32x2e+32x3o | 4096 weights)
      (skip_tp): FullyConnectedTensorProduct(32x0e x 3x0e -> 32x0e | 3072 paths | 3072 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0-1): 2 x EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 3x4x32 (cuda:0)]
                (1): Parameter containing: [torch.float64 of size 3x1x32 (cuda:0)]
            )
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(32x0e -> 32x0e | 1024 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(32x0e -> 1x0e | 32 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(32x0e -> 16x0e | 512 weights)
      (non_linearity): Activation [x] (16x0e -> 16x0e)
      (linear_2): Linear(16x0e -> 1x0e | 16 weights)
    )
  )
  (scale_shift): ScaleShiftBlock(scale=2.2278, shift=0.0000)
)
2025-09-08 16:48:25.668 INFO: Total number of parameters: 67472
2025-09-08 16:48:25.668 INFO: 
2025-09-08 16:48:25.668 INFO: ===========OPTIMIZER INFORMATION===========
2025-09-08 16:48:25.668 INFO: Using ADAM as parameter optimizer
2025-09-08 16:48:25.668 INFO: Batch size: 10
2025-09-08 16:48:25.669 INFO: Number of gradient updates: 1800
2025-09-08 16:48:25.669 INFO: Learning rate: 0.01, weight decay: 5e-07
2025-09-08 16:48:25.669 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=100.000)
2025-09-08 16:48:25.669 INFO: Stage Two (after 75 epochs) with loss function: WeightedEnergyForcesLoss(energy_weight=1000.000, forces_weight=100.000), with energy weight : 1000.0, forces weight : 100.0 and learning rate : 0.001
2025-09-08 16:48:26.015 INFO: Using gradient clipping with tolerance=10.000
2025-09-08 16:48:26.015 INFO: 
2025-09-08 16:48:26.015 INFO: ===========TRAINING===========
2025-09-08 16:48:26.015 INFO: Started training, reporting errors on validation set
2025-09-08 16:48:26.016 INFO: Loss metrics on validation set
2025-09-08 17:02:00.806 INFO: ===========VERIFYING SETTINGS===========
2025-09-08 17:02:00.807 INFO: Process group initialized: True
2025-09-08 17:02:00.811 INFO: Processes: 8
2025-09-08 17:02:00.811 INFO: MACE version: 0.3.13
2025-09-08 17:02:00.812 DEBUG: Configuration: Namespace(name='mace01', seed=123, work_dir='.', log_dir='./logs', model_dir='.', checkpoints_dir='./checkpoints', results_dir='./results', downloads_dir='./downloads', device='cuda', default_dtype='float64', distributed=True, log_level='INFO', plot=True, plot_frequency=0, error_table='PerAtomRMSE', model='MACE', r_max=4.0, radial_type='bessel', num_radial_basis=8, num_cutoff_basis=5, pair_repulsion=False, distance_transform='None', interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', radial_MLP='[64, 64, 64]', hidden_irreps=32x0e, num_channels=32, max_L=0, gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, compute_stress=False, compute_forces=True, train_file='/work/home/onescience2025/yuxiaodong/mace/chemistry/data/solvent_xtb_train_200.xyz', valid_file=None, valid_fraction=0.1, test_file='/work/home/onescience2025/yuxiaodong/mace/chemistry/data/solvent_xtb_test.xyz', test_dir=None, multi_processed_test=False, num_workers=8, pin_memory=True, atomic_numbers=None, mean=None, std=None, statistics_file=None, E0s=None, foundation_filter_elements=True, heads=None, multiheads_finetuning=True, foundation_head=None, weight_pt_head=1.0, num_samples_pt=10000, force_mh_ft_lr=False, subselect_pt='random', filter_type_pt='none', pt_train_file=None, pt_valid_file=None, foundation_model_elements=False, keep_isolated_atoms=False, energy_key='energy_xtb', forces_key='forces_xtb', virials_key='REF_virials', stress_key='REF_stress', dipole_key='dipole', head_key='head', charges_key='REF_charges', skip_evaluate_heads='pt_head', loss='weighted', forces_weight=100.0, swa_forces_weight=100.0, energy_weight=1.0, swa_energy_weight=1000.0, virials_weight=1.0, swa_virials_weight=10.0, stress_weight=1.0, swa_stress_weight=10.0, dipole_weight=1.0, swa_dipole_weight=1.0, config_type_weights='{"Default":1.0}', huber_delta=0.01, optimizer='adam', beta=0.9, batch_size=2, valid_batch_size=10, lr=0.01, swa_lr=0.001, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_patience=50, lr_scheduler_gamma=0.9993, swa=True, start_swa=75, lbfgs=False, ema=False, ema_decay=0.99, max_num_epochs=100, patience=2048, foundation_model=None, foundation_model_readout=True, eval_interval=1, keep_checkpoints=False, save_all_checkpoints=False, restart_latest=False, save_cpu=False, clip_grad=10.0, dry_run=False, enable_cueq=False, wandb=False, wandb_dir=None, wandb_project='', wandb_entity='', wandb_name='', wandb_log_hypers=['num_channels', 'max_L', 'correlation', 'lr', 'swa_lr', 'weight_decay', 'batch_size', 'max_num_epochs', 'start_swa', 'energy_weight', 'forces_weight'], key_specification=KeySpecification(info_keys={'energy': 'energy_xtb', 'stress': 'REF_stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head'}, arrays_keys={'forces': 'forces_xtb', 'charges': 'REF_charges'}))
2025-09-08 17:02:00.812 INFO: CUDA version: None, CUDA device: 0
2025-09-08 17:02:00.862 DEBUG: Popen(['git', 'version'], cwd=/work/home/onescience2025/yuxiaodong/onescience-main, stdin=None, shell=False, universal_newlines=False)
2025-09-08 17:02:00.862 DEBUG: Popen(['git', 'version'], cwd=/work/home/onescience2025/yuxiaodong/onescience-main, stdin=None, shell=False, universal_newlines=False)
2025-09-08 17:02:00.862 DEBUG: Popen(['git', 'version'], cwd=/work/home/onescience2025/yuxiaodong/onescience-main, stdin=None, shell=False, universal_newlines=False)
2025-09-08 17:02:00.862 DEBUG: Popen(['git', 'version'], cwd=/work/home/onescience2025/yuxiaodong/onescience-main, stdin=None, shell=False, universal_newlines=False)
2025-09-08 17:02:00.868 DEBUG: Popen(['git', 'version'], cwd=/work/home/onescience2025/yuxiaodong/onescience-main, stdin=None, shell=False, universal_newlines=False)
2025-09-08 17:02:00.868 DEBUG: Popen(['git', 'version'], cwd=/work/home/onescience2025/yuxiaodong/onescience-main, stdin=None, shell=False, universal_newlines=False)
2025-09-08 17:02:00.869 DEBUG: Popen(['git', 'version'], cwd=/work/home/onescience2025/yuxiaodong/onescience-main, stdin=None, shell=False, universal_newlines=False)
2025-09-08 17:02:00.869 DEBUG: Popen(['git', 'version'], cwd=/work/home/onescience2025/yuxiaodong/onescience-main, stdin=None, shell=False, universal_newlines=False)
2025-09-08 17:02:00.872 DEBUG: sys.platform='linux', git_executable='git'
2025-09-08 17:02:00.873 DEBUG: sys.platform='linux', git_executable='git'
2025-09-08 17:02:00.874 DEBUG: sys.platform='linux', git_executable='git'
2025-09-08 17:02:00.874 DEBUG: sys.platform='linux', git_executable='git'
2025-09-08 17:02:00.875 DEBUG: Error accessing Git repository: /work/home/onescience2025/yuxiaodong/onescience-main
2025-09-08 17:02:00.875 INFO: ===========LOADING INPUT DATA===========
2025-09-08 17:02:00.875 INFO: Using heads: ['Default']
2025-09-08 17:02:00.875 INFO: Using the key specifications to parse data:
2025-09-08 17:02:00.875 INFO: Default: KeySpecification(info_keys={'energy': 'energy_xtb', 'stress': 'REF_stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head'}, arrays_keys={'forces': 'forces_xtb', 'charges': 'REF_charges'})
2025-09-08 17:02:00.875 INFO: =============    Processing head Default     ===========
2025-09-08 17:02:00.876 DEBUG: Loading training file: /work/home/onescience2025/yuxiaodong/mace/chemistry/data/solvent_xtb_train_200.xyz
2025-09-08 17:02:00.889 DEBUG: Popen(['git', 'version'], cwd=/work/home/onescience2025/yuxiaodong/onescience-main, stdin=None, shell=False, universal_newlines=False)
2025-09-08 17:02:00.889 DEBUG: Popen(['git', 'version'], cwd=/work/home/onescience2025/yuxiaodong/onescience-main, stdin=None, shell=False, universal_newlines=False)
2025-09-08 17:02:00.889 DEBUG: Popen(['git', 'version'], cwd=/work/home/onescience2025/yuxiaodong/onescience-main, stdin=None, shell=False, universal_newlines=False)
2025-09-08 17:02:00.889 DEBUG: Popen(['git', 'version'], cwd=/work/home/onescience2025/yuxiaodong/onescience-main, stdin=None, shell=False, universal_newlines=False)
2025-09-08 17:02:00.897 DEBUG: Popen(['git', 'version'], cwd=/work/home/onescience2025/yuxiaodong/onescience-main, stdin=None, shell=False, universal_newlines=False)
2025-09-08 17:02:00.898 DEBUG: Popen(['git', 'version'], cwd=/work/home/onescience2025/yuxiaodong/onescience-main, stdin=None, shell=False, universal_newlines=False)
2025-09-08 17:02:00.898 DEBUG: Popen(['git', 'version'], cwd=/work/home/onescience2025/yuxiaodong/onescience-main, stdin=None, shell=False, universal_newlines=False)
2025-09-08 17:02:00.898 DEBUG: Popen(['git', 'version'], cwd=/work/home/onescience2025/yuxiaodong/onescience-main, stdin=None, shell=False, universal_newlines=False)
2025-09-08 17:02:00.900 DEBUG: sys.platform='linux', git_executable='git'
2025-09-08 17:02:00.902 DEBUG: sys.platform='linux', git_executable='git'
2025-09-08 17:02:00.902 DEBUG: sys.platform='linux', git_executable='git'
2025-09-08 17:02:00.902 DEBUG: sys.platform='linux', git_executable='git'
2025-09-08 17:02:00.979 INFO: Using isolated atom energies from training file
2025-09-08 17:02:00.990 INFO: Training set 1/1 [energy: 200, stress: 0, virials: 0, dipole components: 0, head: 200, forces: 200, charges: 0]
2025-09-08 17:02:00.991 INFO: Total Training set [energy: 200, stress: 0, virials: 0, dipole components: 0, head: 200, forces: 200, charges: 0]
2025-09-08 17:02:00.991 INFO: No validation set provided, splitting training data instead.
2025-09-08 17:02:00.992 INFO: Using random 10% of training set for validation with indices saved in: ./valid_indices_123.txt
2025-09-08 17:02:00.994 INFO: Random Split Training set [energy: 180, stress: 0, virials: 0, dipole components: 0, head: 180, forces: 180, charges: 0]
2025-09-08 17:02:00.995 INFO: Random Split Validation set [energy: 20, stress: 0, virials: 0, dipole components: 0, head: 20, forces: 20, charges: 0]
2025-09-08 17:02:01.421 INFO: Test set 1/1 [energy: 1000, stress: 0, virials: 0, dipole components: 0, head: 1000, forces: 1000, charges: 0]
2025-09-08 17:02:01.428 INFO: Total Test set [energy: 1000, stress: 0, virials: 0, dipole components: 0, head: 1000, forces: 1000, charges: 0]
2025-09-08 17:02:01.429 DEBUG: Element 1 found in 1 file. Using E0: -10.707211 eV
2025-09-08 17:02:01.429 DEBUG: Element 6 found in 1 file. Using E0: -48.847445 eV
2025-09-08 17:02:01.429 DEBUG: Element 8 found in 1 file. Using E0: -102.571173 eV
2025-09-08 17:02:01.429 INFO: Total number of configurations: train=180, valid=20, tests=[Default_Default: 1000],
2025-09-08 17:02:01.430 INFO: Atomic Numbers used: [1, 6, 8]
2025-09-08 17:02:01.430 INFO: Atomic Energies used (z: eV) for head Default: {1: -10.707211383396714, 6: -48.847445262804705, 8: -102.57117256025786}
2025-09-08 17:02:01.431 INFO: Processing datasets for head 'Default'
2025-09-08 17:02:01.542 DEBUG: Successfully loaded dataset from ASE files: ['/work/home/onescience2025/yuxiaodong/mace/chemistry/data/solvent_xtb_train_200.xyz']
2025-09-08 17:02:01.543 INFO: Combining 1 list datasets for head 'Default'
2025-09-08 17:02:01.553 INFO: Head 'Default' training dataset size: 180
2025-09-08 17:02:01.554 INFO: Computing average number of neighbors
2025-09-08 17:02:04.135 INFO: Average number of neighbors: 9.862346247328155
2025-09-08 17:02:04.136 INFO: During training the following quantities will be reported: energy, forces
2025-09-08 17:02:04.136 INFO: ===========MODEL DETAILS===========
2025-09-08 17:02:04.469 INFO: Building model
2025-09-08 17:02:04.469 INFO: Message passing with 32 channels and max_L=0 (32x0e)
2025-09-08 17:02:04.470 INFO: 2 layers, each with correlation order: 3 (body order: 4) and spherical harmonics up to: l=3
2025-09-08 17:02:04.470 INFO: 8 radial and 5 basis functions
2025-09-08 17:02:04.470 INFO: Radial cutoff: 4.0 A (total receptive field for each atom: 8.0 A)
2025-09-08 17:02:04.470 INFO: Distance transform for radial basis functions: None
2025-09-08 17:02:04.470 INFO: Hidden irreps: 32x0e
2025-09-08 17:02:06.103 DEBUG: ScaleShiftMACE(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(3x0e -> 32x0e | 96 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=4.0, num_basis=8, trainable=False)
    (cutoff_fn): PolynomialCutoff(p=5, r_max=4.0)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[[-10.7072, -48.8474, -102.5712]])
  (interactions): ModuleList(
    (0): RealAgnosticInteractionBlock(
      (linear_up): Linear(32x0e -> 32x0e | 1024 weights)
      (conv_tp): TensorProduct(32x0e x 1x0e+1x1o+1x2e+1x3o -> 32x0e+32x1o+32x2e+32x3o | 128 paths | 128 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 128]
      (linear): Linear(32x0e+32x1o+32x2e+32x3o -> 32x0e+32x1o+32x2e+32x3o | 4096 weights)
      (skip_tp): FullyConnectedTensorProduct(32x0e+32x1o+32x2e+32x3o x 3x0e -> 32x0e+32x1o+32x2e+32x3o | 12288 paths | 12288 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(32x0e -> 32x0e | 1024 weights)
      (conv_tp): TensorProduct(32x0e x 1x0e+1x1o+1x2e+1x3o -> 32x0e+32x1o+32x2e+32x3o | 128 paths | 128 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 128]
      (linear): Linear(32x0e+32x1o+32x2e+32x3o -> 32x0e+32x1o+32x2e+32x3o | 4096 weights)
      (skip_tp): FullyConnectedTensorProduct(32x0e x 3x0e -> 32x0e | 3072 paths | 3072 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0-1): 2 x EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 3x4x32 (cuda:0)]
                (1): Parameter containing: [torch.float64 of size 3x1x32 (cuda:0)]
            )
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(32x0e -> 32x0e | 1024 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(32x0e -> 1x0e | 32 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(32x0e -> 16x0e | 512 weights)
      (non_linearity): Activation [x] (16x0e -> 16x0e)
      (linear_2): Linear(16x0e -> 1x0e | 16 weights)
    )
  )
  (scale_shift): ScaleShiftBlock(scale=2.2278, shift=0.0000)
)
2025-09-08 17:02:06.105 INFO: Total number of parameters: 67472
2025-09-08 17:02:06.105 INFO: 
2025-09-08 17:02:06.105 INFO: ===========OPTIMIZER INFORMATION===========
2025-09-08 17:02:06.105 INFO: Using ADAM as parameter optimizer
2025-09-08 17:02:06.106 INFO: Batch size: 2
2025-09-08 17:02:06.106 INFO: Number of gradient updates: 9000
2025-09-08 17:02:06.106 INFO: Learning rate: 0.01, weight decay: 5e-07
2025-09-08 17:02:06.106 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=100.000)
2025-09-08 17:02:06.107 INFO: Stage Two (after 75 epochs) with loss function: WeightedEnergyForcesLoss(energy_weight=1000.000, forces_weight=100.000), with energy weight : 1000.0, forces weight : 100.0 and learning rate : 0.001
2025-09-08 17:02:06.455 INFO: Using gradient clipping with tolerance=10.000
2025-09-08 17:02:06.456 INFO: 
2025-09-08 17:02:06.456 INFO: ===========TRAINING===========
2025-09-08 17:02:06.456 INFO: Started training, reporting errors on validation set
2025-09-08 17:02:06.456 INFO: Loss metrics on validation set
2025-09-08 17:03:55.274 INFO: ===========VERIFYING SETTINGS===========
2025-09-08 17:03:55.279 INFO: Process group initialized: True
2025-09-08 17:03:55.279 INFO: Processes: 8
2025-09-08 17:03:55.279 INFO: MACE version: 0.3.13
2025-09-08 17:03:55.280 DEBUG: Configuration: Namespace(name='mace01', seed=123, work_dir='.', log_dir='./logs', model_dir='.', checkpoints_dir='./checkpoints', results_dir='./results', downloads_dir='./downloads', device='cuda', default_dtype='float64', distributed=True, log_level='INFO', plot=True, plot_frequency=0, error_table='PerAtomRMSE', model='MACE', r_max=4.0, radial_type='bessel', num_radial_basis=8, num_cutoff_basis=5, pair_repulsion=False, distance_transform='None', interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', radial_MLP='[64, 64, 64]', hidden_irreps=32x0e, num_channels=32, max_L=0, gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, compute_stress=False, compute_forces=True, train_file='/work/home/onescience2025/yuxiaodong/mace/chemistry/data/solvent_xtb_train_200.xyz', valid_file=None, valid_fraction=0.1, test_file='/work/home/onescience2025/yuxiaodong/mace/chemistry/data/solvent_xtb_test.xyz', test_dir=None, multi_processed_test=False, num_workers=8, pin_memory=True, atomic_numbers=None, mean=None, std=None, statistics_file=None, E0s=None, foundation_filter_elements=True, heads=None, multiheads_finetuning=True, foundation_head=None, weight_pt_head=1.0, num_samples_pt=10000, force_mh_ft_lr=False, subselect_pt='random', filter_type_pt='none', pt_train_file=None, pt_valid_file=None, foundation_model_elements=False, keep_isolated_atoms=False, energy_key='energy_xtb', forces_key='forces_xtb', virials_key='REF_virials', stress_key='REF_stress', dipole_key='dipole', head_key='head', charges_key='REF_charges', skip_evaluate_heads='pt_head', loss='weighted', forces_weight=100.0, swa_forces_weight=100.0, energy_weight=1.0, swa_energy_weight=1000.0, virials_weight=1.0, swa_virials_weight=10.0, stress_weight=1.0, swa_stress_weight=10.0, dipole_weight=1.0, swa_dipole_weight=1.0, config_type_weights='{"Default":1.0}', huber_delta=0.01, optimizer='adam', beta=0.9, batch_size=1, valid_batch_size=10, lr=0.01, swa_lr=0.001, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_patience=50, lr_scheduler_gamma=0.9993, swa=True, start_swa=75, lbfgs=False, ema=False, ema_decay=0.99, max_num_epochs=100, patience=2048, foundation_model=None, foundation_model_readout=True, eval_interval=1, keep_checkpoints=False, save_all_checkpoints=False, restart_latest=False, save_cpu=False, clip_grad=10.0, dry_run=False, enable_cueq=False, wandb=False, wandb_dir=None, wandb_project='', wandb_entity='', wandb_name='', wandb_log_hypers=['num_channels', 'max_L', 'correlation', 'lr', 'swa_lr', 'weight_decay', 'batch_size', 'max_num_epochs', 'start_swa', 'energy_weight', 'forces_weight'], key_specification=KeySpecification(info_keys={'energy': 'energy_xtb', 'stress': 'REF_stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head'}, arrays_keys={'forces': 'forces_xtb', 'charges': 'REF_charges'}))
2025-09-08 17:03:55.280 INFO: CUDA version: None, CUDA device: 0
2025-09-08 17:03:55.372 DEBUG: Popen(['git', 'version'], cwd=/work/home/onescience2025/yuxiaodong/onescience-main, stdin=None, shell=False, universal_newlines=False)
2025-09-08 17:03:55.372 DEBUG: Popen(['git', 'version'], cwd=/work/home/onescience2025/yuxiaodong/onescience-main, stdin=None, shell=False, universal_newlines=False)
2025-09-08 17:03:55.372 DEBUG: Popen(['git', 'version'], cwd=/work/home/onescience2025/yuxiaodong/onescience-main, stdin=None, shell=False, universal_newlines=False)
2025-09-08 17:03:55.372 DEBUG: Popen(['git', 'version'], cwd=/work/home/onescience2025/yuxiaodong/onescience-main, stdin=None, shell=False, universal_newlines=False)
2025-09-08 17:03:55.374 DEBUG: Popen(['git', 'version'], cwd=/work/home/onescience2025/yuxiaodong/onescience-main, stdin=None, shell=False, universal_newlines=False)
2025-09-08 17:03:55.374 DEBUG: Popen(['git', 'version'], cwd=/work/home/onescience2025/yuxiaodong/onescience-main, stdin=None, shell=False, universal_newlines=False)
2025-09-08 17:03:55.374 DEBUG: Popen(['git', 'version'], cwd=/work/home/onescience2025/yuxiaodong/onescience-main, stdin=None, shell=False, universal_newlines=False)
2025-09-08 17:03:55.374 DEBUG: Popen(['git', 'version'], cwd=/work/home/onescience2025/yuxiaodong/onescience-main, stdin=None, shell=False, universal_newlines=False)
2025-09-08 17:03:55.377 DEBUG: Popen(['git', 'version'], cwd=/work/home/onescience2025/yuxiaodong/onescience-main, stdin=None, shell=False, universal_newlines=False)
2025-09-08 17:03:55.379 DEBUG: Popen(['git', 'version'], cwd=/work/home/onescience2025/yuxiaodong/onescience-main, stdin=None, shell=False, universal_newlines=False)
2025-09-08 17:03:55.379 DEBUG: Popen(['git', 'version'], cwd=/work/home/onescience2025/yuxiaodong/onescience-main, stdin=None, shell=False, universal_newlines=False)
2025-09-08 17:03:55.379 DEBUG: Popen(['git', 'version'], cwd=/work/home/onescience2025/yuxiaodong/onescience-main, stdin=None, shell=False, universal_newlines=False)
2025-09-08 17:03:55.382 DEBUG: Popen(['git', 'version'], cwd=/work/home/onescience2025/yuxiaodong/onescience-main, stdin=None, shell=False, universal_newlines=False)
2025-09-08 17:03:55.383 DEBUG: Popen(['git', 'version'], cwd=/work/home/onescience2025/yuxiaodong/onescience-main, stdin=None, shell=False, universal_newlines=False)
2025-09-08 17:03:55.383 DEBUG: Popen(['git', 'version'], cwd=/work/home/onescience2025/yuxiaodong/onescience-main, stdin=None, shell=False, universal_newlines=False)
2025-09-08 17:03:55.383 DEBUG: Popen(['git', 'version'], cwd=/work/home/onescience2025/yuxiaodong/onescience-main, stdin=None, shell=False, universal_newlines=False)
2025-09-08 17:03:55.386 DEBUG: sys.platform='linux', git_executable='git'
2025-09-08 17:03:55.386 DEBUG: sys.platform='linux', git_executable='git'
2025-09-08 17:03:55.387 DEBUG: sys.platform='linux', git_executable='git'
2025-09-08 17:03:55.387 DEBUG: sys.platform='linux', git_executable='git'
2025-09-08 17:03:55.389 DEBUG: Error accessing Git repository: /work/home/onescience2025/yuxiaodong/onescience-main
2025-09-08 17:03:55.389 INFO: ===========LOADING INPUT DATA===========
2025-09-08 17:03:55.389 INFO: Using heads: ['Default']
2025-09-08 17:03:55.389 INFO: Using the key specifications to parse data:
2025-09-08 17:03:55.389 INFO: Default: KeySpecification(info_keys={'energy': 'energy_xtb', 'stress': 'REF_stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head'}, arrays_keys={'forces': 'forces_xtb', 'charges': 'REF_charges'})
2025-09-08 17:03:55.389 INFO: =============    Processing head Default     ===========
2025-09-08 17:03:55.389 DEBUG: sys.platform='linux', git_executable='git'
2025-09-08 17:03:55.390 DEBUG: Loading training file: /work/home/onescience2025/yuxiaodong/mace/chemistry/data/solvent_xtb_train_200.xyz
2025-09-08 17:03:55.390 DEBUG: sys.platform='linux', git_executable='git'
2025-09-08 17:03:55.390 DEBUG: sys.platform='linux', git_executable='git'
2025-09-08 17:03:55.390 DEBUG: sys.platform='linux', git_executable='git'
2025-09-08 17:03:55.497 INFO: Using isolated atom energies from training file
2025-09-08 17:03:55.508 INFO: Training set 1/1 [energy: 200, stress: 0, virials: 0, dipole components: 0, head: 200, forces: 200, charges: 0]
2025-09-08 17:03:55.509 INFO: Total Training set [energy: 200, stress: 0, virials: 0, dipole components: 0, head: 200, forces: 200, charges: 0]
2025-09-08 17:03:55.510 INFO: No validation set provided, splitting training data instead.
2025-09-08 17:03:55.523 INFO: Using random 10% of training set for validation with indices saved in: ./valid_indices_123.txt
2025-09-08 17:03:55.525 INFO: Random Split Training set [energy: 180, stress: 0, virials: 0, dipole components: 0, head: 180, forces: 180, charges: 0]
2025-09-08 17:03:55.525 INFO: Random Split Validation set [energy: 20, stress: 0, virials: 0, dipole components: 0, head: 20, forces: 20, charges: 0]
2025-09-08 17:03:55.957 INFO: Test set 1/1 [energy: 1000, stress: 0, virials: 0, dipole components: 0, head: 1000, forces: 1000, charges: 0]
2025-09-08 17:03:55.964 INFO: Total Test set [energy: 1000, stress: 0, virials: 0, dipole components: 0, head: 1000, forces: 1000, charges: 0]
2025-09-08 17:03:55.964 DEBUG: Element 1 found in 1 file. Using E0: -10.707211 eV
2025-09-08 17:03:55.964 DEBUG: Element 6 found in 1 file. Using E0: -48.847445 eV
2025-09-08 17:03:55.964 DEBUG: Element 8 found in 1 file. Using E0: -102.571173 eV
2025-09-08 17:03:55.965 INFO: Total number of configurations: train=180, valid=20, tests=[Default_Default: 1000],
2025-09-08 17:03:55.966 INFO: Atomic Numbers used: [1, 6, 8]
2025-09-08 17:03:55.966 INFO: Atomic Energies used (z: eV) for head Default: {1: -10.707211383396714, 6: -48.847445262804705, 8: -102.57117256025786}
2025-09-08 17:03:55.966 INFO: Processing datasets for head 'Default'
2025-09-08 17:03:56.060 DEBUG: Successfully loaded dataset from ASE files: ['/work/home/onescience2025/yuxiaodong/mace/chemistry/data/solvent_xtb_train_200.xyz']
2025-09-08 17:03:56.061 INFO: Combining 1 list datasets for head 'Default'
2025-09-08 17:03:56.071 INFO: Head 'Default' training dataset size: 180
2025-09-08 17:03:56.072 INFO: Computing average number of neighbors
2025-09-08 17:03:58.923 INFO: Average number of neighbors: 9.862346247328155
2025-09-08 17:03:58.923 INFO: During training the following quantities will be reported: energy, forces
2025-09-08 17:03:58.923 INFO: ===========MODEL DETAILS===========
2025-09-08 17:03:59.317 INFO: Building model
2025-09-08 17:03:59.318 INFO: Message passing with 32 channels and max_L=0 (32x0e)
2025-09-08 17:03:59.318 INFO: 2 layers, each with correlation order: 3 (body order: 4) and spherical harmonics up to: l=3
2025-09-08 17:03:59.318 INFO: 8 radial and 5 basis functions
2025-09-08 17:03:59.318 INFO: Radial cutoff: 4.0 A (total receptive field for each atom: 8.0 A)
2025-09-08 17:03:59.318 INFO: Distance transform for radial basis functions: None
2025-09-08 17:03:59.318 INFO: Hidden irreps: 32x0e
2025-09-08 17:04:00.958 DEBUG: ScaleShiftMACE(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(3x0e -> 32x0e | 96 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=4.0, num_basis=8, trainable=False)
    (cutoff_fn): PolynomialCutoff(p=5, r_max=4.0)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[[-10.7072, -48.8474, -102.5712]])
  (interactions): ModuleList(
    (0): RealAgnosticInteractionBlock(
      (linear_up): Linear(32x0e -> 32x0e | 1024 weights)
      (conv_tp): TensorProduct(32x0e x 1x0e+1x1o+1x2e+1x3o -> 32x0e+32x1o+32x2e+32x3o | 128 paths | 128 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 128]
      (linear): Linear(32x0e+32x1o+32x2e+32x3o -> 32x0e+32x1o+32x2e+32x3o | 4096 weights)
      (skip_tp): FullyConnectedTensorProduct(32x0e+32x1o+32x2e+32x3o x 3x0e -> 32x0e+32x1o+32x2e+32x3o | 12288 paths | 12288 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(32x0e -> 32x0e | 1024 weights)
      (conv_tp): TensorProduct(32x0e x 1x0e+1x1o+1x2e+1x3o -> 32x0e+32x1o+32x2e+32x3o | 128 paths | 128 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 128]
      (linear): Linear(32x0e+32x1o+32x2e+32x3o -> 32x0e+32x1o+32x2e+32x3o | 4096 weights)
      (skip_tp): FullyConnectedTensorProduct(32x0e x 3x0e -> 32x0e | 3072 paths | 3072 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0-1): 2 x EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 3x4x32 (cuda:0)]
                (1): Parameter containing: [torch.float64 of size 3x1x32 (cuda:0)]
            )
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(32x0e -> 32x0e | 1024 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(32x0e -> 1x0e | 32 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(32x0e -> 16x0e | 512 weights)
      (non_linearity): Activation [x] (16x0e -> 16x0e)
      (linear_2): Linear(16x0e -> 1x0e | 16 weights)
    )
  )
  (scale_shift): ScaleShiftBlock(scale=2.2278, shift=0.0000)
)
2025-09-08 17:04:00.960 INFO: Total number of parameters: 67472
2025-09-08 17:04:00.960 INFO: 
2025-09-08 17:04:00.960 INFO: ===========OPTIMIZER INFORMATION===========
2025-09-08 17:04:00.960 INFO: Using ADAM as parameter optimizer
2025-09-08 17:04:00.961 INFO: Batch size: 1
2025-09-08 17:04:00.961 INFO: Number of gradient updates: 18000
2025-09-08 17:04:00.961 INFO: Learning rate: 0.01, weight decay: 5e-07
2025-09-08 17:04:00.961 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=100.000)
2025-09-08 17:04:00.962 INFO: Stage Two (after 75 epochs) with loss function: WeightedEnergyForcesLoss(energy_weight=1000.000, forces_weight=100.000), with energy weight : 1000.0, forces weight : 100.0 and learning rate : 0.001
2025-09-08 17:04:01.247 INFO: Using gradient clipping with tolerance=10.000
2025-09-08 17:04:01.247 INFO: 
2025-09-08 17:04:01.247 INFO: ===========TRAINING===========
2025-09-08 17:04:01.247 INFO: Started training, reporting errors on validation set
2025-09-08 17:04:01.247 INFO: Loss metrics on validation set
2025-09-08 17:07:44.476 DEBUG: Popen(['git', 'version'], cwd=/work/home/onescience2025/yuxiaodong/onescience-main, stdin=None, shell=False, universal_newlines=False)
2025-09-08 17:07:44.476 DEBUG: Popen(['git', 'version'], cwd=/work/home/onescience2025/yuxiaodong/onescience-main, stdin=None, shell=False, universal_newlines=False)
2025-09-08 17:07:44.476 DEBUG: Popen(['git', 'version'], cwd=/work/home/onescience2025/yuxiaodong/onescience-main, stdin=None, shell=False, universal_newlines=False)
2025-09-08 17:07:44.482 DEBUG: Popen(['git', 'version'], cwd=/work/home/onescience2025/yuxiaodong/onescience-main, stdin=None, shell=False, universal_newlines=False)
2025-09-08 17:07:44.483 DEBUG: Popen(['git', 'version'], cwd=/work/home/onescience2025/yuxiaodong/onescience-main, stdin=None, shell=False, universal_newlines=False)
2025-09-08 17:07:44.483 DEBUG: Popen(['git', 'version'], cwd=/work/home/onescience2025/yuxiaodong/onescience-main, stdin=None, shell=False, universal_newlines=False)
2025-09-08 17:07:44.486 DEBUG: sys.platform='linux', git_executable='git'
2025-09-08 17:07:44.488 DEBUG: sys.platform='linux', git_executable='git'
2025-09-08 17:07:44.488 DEBUG: sys.platform='linux', git_executable='git'
2025-09-08 17:07:44.633 INFO: ===========VERIFYING SETTINGS===========
2025-09-08 17:07:44.636 INFO: Process group initialized: True
2025-09-08 17:07:44.636 INFO: Processes: 8
2025-09-08 17:07:44.636 INFO: MACE version: 0.3.13
2025-09-08 17:07:44.636 DEBUG: Configuration: Namespace(name='mace01', seed=123, work_dir='.', log_dir='./logs', model_dir='.', checkpoints_dir='./checkpoints', results_dir='./results', downloads_dir='./downloads', device='cuda', default_dtype='float64', distributed=True, log_level='INFO', plot=True, plot_frequency=0, error_table='PerAtomRMSE', model='MACE', r_max=4.0, radial_type='bessel', num_radial_basis=8, num_cutoff_basis=5, pair_repulsion=False, distance_transform='None', interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', radial_MLP='[64, 64, 64]', hidden_irreps=32x0e, num_channels=32, max_L=0, gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, compute_stress=False, compute_forces=True, train_file='/work/home/onescience2025/yuxiaodong/mace/chemistry/data/solvent_xtb_train_200.xyz', valid_file=None, valid_fraction=0.1, test_file='/work/home/onescience2025/yuxiaodong/mace/chemistry/data/solvent_xtb_test.xyz', test_dir=None, multi_processed_test=False, num_workers=8, pin_memory=True, atomic_numbers=None, mean=None, std=None, statistics_file=None, E0s=None, foundation_filter_elements=True, heads=None, multiheads_finetuning=True, foundation_head=None, weight_pt_head=1.0, num_samples_pt=10000, force_mh_ft_lr=False, subselect_pt='random', filter_type_pt='none', pt_train_file=None, pt_valid_file=None, foundation_model_elements=False, keep_isolated_atoms=False, energy_key='energy_xtb', forces_key='forces_xtb', virials_key='REF_virials', stress_key='REF_stress', dipole_key='dipole', head_key='head', charges_key='REF_charges', skip_evaluate_heads='pt_head', loss='weighted', forces_weight=100.0, swa_forces_weight=100.0, energy_weight=1.0, swa_energy_weight=1000.0, virials_weight=1.0, swa_virials_weight=10.0, stress_weight=1.0, swa_stress_weight=10.0, dipole_weight=1.0, swa_dipole_weight=1.0, config_type_weights='{"Default":1.0}', huber_delta=0.01, optimizer='adam', beta=0.9, batch_size=1, valid_batch_size=10, lr=0.01, swa_lr=0.001, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_patience=50, lr_scheduler_gamma=0.9993, swa=True, start_swa=75, lbfgs=False, ema=False, ema_decay=0.99, max_num_epochs=100, patience=2048, foundation_model=None, foundation_model_readout=True, eval_interval=1, keep_checkpoints=False, save_all_checkpoints=False, restart_latest=False, save_cpu=False, clip_grad=10.0, dry_run=False, enable_cueq=False, wandb=False, wandb_dir=None, wandb_project='', wandb_entity='', wandb_name='', wandb_log_hypers=['num_channels', 'max_L', 'correlation', 'lr', 'swa_lr', 'weight_decay', 'batch_size', 'max_num_epochs', 'start_swa', 'energy_weight', 'forces_weight'], key_specification=KeySpecification(info_keys={'energy': 'energy_xtb', 'stress': 'REF_stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head'}, arrays_keys={'forces': 'forces_xtb', 'charges': 'REF_charges'}))
2025-09-08 17:07:44.636 INFO: CUDA version: None, CUDA device: 0
2025-09-08 17:07:44.685 DEBUG: Popen(['git', 'version'], cwd=/work/home/onescience2025/yuxiaodong/onescience-main, stdin=None, shell=False, universal_newlines=False)
2025-09-08 17:07:44.689 DEBUG: Popen(['git', 'version'], cwd=/work/home/onescience2025/yuxiaodong/onescience-main, stdin=None, shell=False, universal_newlines=False)
2025-09-08 17:07:44.692 DEBUG: sys.platform='linux', git_executable='git'
2025-09-08 17:07:44.693 DEBUG: Error accessing Git repository: /work/home/onescience2025/yuxiaodong/onescience-main
2025-09-08 17:07:44.694 INFO: ===========LOADING INPUT DATA===========
2025-09-08 17:07:44.694 INFO: Using heads: ['Default']
2025-09-08 17:07:44.694 INFO: Using the key specifications to parse data:
2025-09-08 17:07:44.694 INFO: Default: KeySpecification(info_keys={'energy': 'energy_xtb', 'stress': 'REF_stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head'}, arrays_keys={'forces': 'forces_xtb', 'charges': 'REF_charges'})
2025-09-08 17:07:44.694 INFO: =============    Processing head Default     ===========
2025-09-08 17:07:44.694 DEBUG: Loading training file: /work/home/onescience2025/yuxiaodong/mace/chemistry/data/solvent_xtb_train_200.xyz
2025-09-08 17:07:44.725 DEBUG: Popen(['git', 'version'], cwd=/work/home/onescience2025/yuxiaodong/onescience-main, stdin=None, shell=False, universal_newlines=False)
2025-09-08 17:07:44.725 DEBUG: Popen(['git', 'version'], cwd=/work/home/onescience2025/yuxiaodong/onescience-main, stdin=None, shell=False, universal_newlines=False)
2025-09-08 17:07:44.725 DEBUG: Popen(['git', 'version'], cwd=/work/home/onescience2025/yuxiaodong/onescience-main, stdin=None, shell=False, universal_newlines=False)
2025-09-08 17:07:44.725 DEBUG: Popen(['git', 'version'], cwd=/work/home/onescience2025/yuxiaodong/onescience-main, stdin=None, shell=False, universal_newlines=False)
2025-09-08 17:07:44.733 DEBUG: Popen(['git', 'version'], cwd=/work/home/onescience2025/yuxiaodong/onescience-main, stdin=None, shell=False, universal_newlines=False)
2025-09-08 17:07:44.734 DEBUG: Popen(['git', 'version'], cwd=/work/home/onescience2025/yuxiaodong/onescience-main, stdin=None, shell=False, universal_newlines=False)
2025-09-08 17:07:44.735 DEBUG: Popen(['git', 'version'], cwd=/work/home/onescience2025/yuxiaodong/onescience-main, stdin=None, shell=False, universal_newlines=False)
2025-09-08 17:07:44.735 DEBUG: Popen(['git', 'version'], cwd=/work/home/onescience2025/yuxiaodong/onescience-main, stdin=None, shell=False, universal_newlines=False)
2025-09-08 17:07:44.737 DEBUG: sys.platform='linux', git_executable='git'
2025-09-08 17:07:44.738 DEBUG: sys.platform='linux', git_executable='git'
2025-09-08 17:07:44.739 DEBUG: sys.platform='linux', git_executable='git'
2025-09-08 17:07:44.739 DEBUG: sys.platform='linux', git_executable='git'
2025-09-08 17:07:44.798 INFO: Using isolated atom energies from training file
2025-09-08 17:07:44.810 INFO: Training set 1/1 [energy: 200, stress: 0, virials: 0, dipole components: 0, head: 200, forces: 200, charges: 0]
2025-09-08 17:07:44.811 INFO: Total Training set [energy: 200, stress: 0, virials: 0, dipole components: 0, head: 200, forces: 200, charges: 0]
2025-09-08 17:07:44.812 INFO: No validation set provided, splitting training data instead.
2025-09-08 17:07:44.813 INFO: Using random 10% of training set for validation with indices saved in: ./valid_indices_123.txt
2025-09-08 17:07:44.815 INFO: Random Split Training set [energy: 180, stress: 0, virials: 0, dipole components: 0, head: 180, forces: 180, charges: 0]
2025-09-08 17:07:44.815 INFO: Random Split Validation set [energy: 20, stress: 0, virials: 0, dipole components: 0, head: 20, forces: 20, charges: 0]
2025-09-08 17:07:45.246 INFO: Test set 1/1 [energy: 1000, stress: 0, virials: 0, dipole components: 0, head: 1000, forces: 1000, charges: 0]
2025-09-08 17:07:45.253 INFO: Total Test set [energy: 1000, stress: 0, virials: 0, dipole components: 0, head: 1000, forces: 1000, charges: 0]
2025-09-08 17:07:45.253 DEBUG: Element 1 found in 1 file. Using E0: -10.707211 eV
2025-09-08 17:07:45.253 DEBUG: Element 6 found in 1 file. Using E0: -48.847445 eV
2025-09-08 17:07:45.253 DEBUG: Element 8 found in 1 file. Using E0: -102.571173 eV
2025-09-08 17:07:45.253 INFO: Total number of configurations: train=180, valid=20, tests=[Default_Default: 1000],
2025-09-08 17:07:45.255 INFO: Atomic Numbers used: [1, 6, 8]
2025-09-08 17:07:45.255 INFO: Atomic Energies used (z: eV) for head Default: {1: -10.707211383396714, 6: -48.847445262804705, 8: -102.57117256025786}
2025-09-08 17:07:45.255 INFO: Processing datasets for head 'Default'
2025-09-08 17:07:45.371 DEBUG: Successfully loaded dataset from ASE files: ['/work/home/onescience2025/yuxiaodong/mace/chemistry/data/solvent_xtb_train_200.xyz']
2025-09-08 17:07:45.371 INFO: Combining 1 list datasets for head 'Default'
2025-09-08 17:07:45.382 INFO: Head 'Default' training dataset size: 180
2025-09-08 17:07:45.383 INFO: Computing average number of neighbors
2025-09-08 17:07:48.884 INFO: Average number of neighbors: 9.862346247328155
2025-09-08 17:07:48.884 INFO: During training the following quantities will be reported: energy, forces
2025-09-08 17:07:48.884 INFO: ===========MODEL DETAILS===========
2025-09-08 17:07:49.262 INFO: Building model
2025-09-08 17:07:49.263 INFO: Message passing with 32 channels and max_L=0 (32x0e)
2025-09-08 17:07:49.263 INFO: 2 layers, each with correlation order: 3 (body order: 4) and spherical harmonics up to: l=3
2025-09-08 17:07:49.263 INFO: 8 radial and 5 basis functions
2025-09-08 17:07:49.263 INFO: Radial cutoff: 4.0 A (total receptive field for each atom: 8.0 A)
2025-09-08 17:07:49.263 INFO: Distance transform for radial basis functions: None
2025-09-08 17:07:49.263 INFO: Hidden irreps: 32x0e
2025-09-08 17:07:50.895 DEBUG: ScaleShiftMACE(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(3x0e -> 32x0e | 96 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=4.0, num_basis=8, trainable=False)
    (cutoff_fn): PolynomialCutoff(p=5, r_max=4.0)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[[-10.7072, -48.8474, -102.5712]])
  (interactions): ModuleList(
    (0): RealAgnosticInteractionBlock(
      (linear_up): Linear(32x0e -> 32x0e | 1024 weights)
      (conv_tp): TensorProduct(32x0e x 1x0e+1x1o+1x2e+1x3o -> 32x0e+32x1o+32x2e+32x3o | 128 paths | 128 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 128]
      (linear): Linear(32x0e+32x1o+32x2e+32x3o -> 32x0e+32x1o+32x2e+32x3o | 4096 weights)
      (skip_tp): FullyConnectedTensorProduct(32x0e+32x1o+32x2e+32x3o x 3x0e -> 32x0e+32x1o+32x2e+32x3o | 12288 paths | 12288 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(32x0e -> 32x0e | 1024 weights)
      (conv_tp): TensorProduct(32x0e x 1x0e+1x1o+1x2e+1x3o -> 32x0e+32x1o+32x2e+32x3o | 128 paths | 128 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 128]
      (linear): Linear(32x0e+32x1o+32x2e+32x3o -> 32x0e+32x1o+32x2e+32x3o | 4096 weights)
      (skip_tp): FullyConnectedTensorProduct(32x0e x 3x0e -> 32x0e | 3072 paths | 3072 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0-1): 2 x EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 3x4x32 (cuda:0)]
                (1): Parameter containing: [torch.float64 of size 3x1x32 (cuda:0)]
            )
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(32x0e -> 32x0e | 1024 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(32x0e -> 1x0e | 32 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(32x0e -> 16x0e | 512 weights)
      (non_linearity): Activation [x] (16x0e -> 16x0e)
      (linear_2): Linear(16x0e -> 1x0e | 16 weights)
    )
  )
  (scale_shift): ScaleShiftBlock(scale=2.2278, shift=0.0000)
)
2025-09-08 17:07:50.897 INFO: Total number of parameters: 67472
2025-09-08 17:07:50.897 INFO: 
2025-09-08 17:07:50.897 INFO: ===========OPTIMIZER INFORMATION===========
2025-09-08 17:07:50.897 INFO: Using ADAM as parameter optimizer
2025-09-08 17:07:50.897 INFO: Batch size: 1
2025-09-08 17:07:50.897 INFO: Number of gradient updates: 18000
2025-09-08 17:07:50.897 INFO: Learning rate: 0.01, weight decay: 5e-07
2025-09-08 17:07:50.897 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=100.000)
2025-09-08 17:07:50.898 INFO: Stage Two (after 75 epochs) with loss function: WeightedEnergyForcesLoss(energy_weight=1000.000, forces_weight=100.000), with energy weight : 1000.0, forces weight : 100.0 and learning rate : 0.001
2025-09-08 17:07:51.018 INFO: Using gradient clipping with tolerance=10.000
2025-09-08 17:07:51.018 INFO: 
2025-09-08 17:07:51.018 INFO: ===========TRAINING===========
2025-09-08 17:07:51.018 INFO: Started training, reporting errors on validation set
2025-09-08 17:07:51.018 INFO: Loss metrics on validation set
