
# DEM_for_J2_plasticity

这是一个基于深度能量法 (DEM，DPINN能量形式)经典弹塑性求解框架。

---

## 1. 方法简介

**深度能量方法（Deep Energy Method, DEM）** 是一种基于变分原理的物理信息神经网络（PINN），通过最小化系统总自由能直接求解弹塑性边值问题。核心特点包括：
- **能量驱动**：以系统总自由能（弹性应变能+硬化能）作为损失函数，仅需位移场的一阶空间梯度。
- **路径依赖性处理**：结合径向返回算法（Radial Return Algorithm）更新塑性内部状态变量（塑性应变、等效塑性应变、背应力等），满足Kuhn-Tucker一致性条件。
- **网格兼容性**：支持结构化/非结构化网格，利用有限元形函数梯度计算位移梯度，提升大变形下的鲁棒性。
- **高效推断**：支持在粗网格训练后，直接迁移到细网格进行快速推断（GPU加速）。

---

## 2. 案例介绍

### 2.1 循环加载下的应力-应变响应
- **问题描述**：矩形板在周期性剪切位移载荷下的弹塑性响应，对比各向同性硬化（Isotropic）与运动硬化（Kinematic）模型。
- **关键结果**：
  - DEM准确捕捉了两种硬化模型的滞回曲线（应力-应变）和等效塑性应变演化。
  - 训练时间约为FEM的2-3倍，但推断效率显著优于FEM。

### 2.2 双材料板的剪切行为
- **问题描述**：由两种不同屈服应力的材料组成的复合板，在单调剪切载荷下的异质应力分布。
- **关键结果**：
  - DEM成功预测界面处的应力跳跃，位移场误差极低（L²误差<0.02%）。
  - 训练时间较长，但验证了方法对材料非均匀性的适应性。

### 2.3 带孔板的循环加载与推断
- **问题描述**：含中心圆孔的矩形板在循环载荷下的局部塑性行为，并在不同细化网格上验证推断能力。
- **关键结果**：
  - 在粗网格（16,670单元）训练后，可直接在细网格（662,120单元）高效推断，总时间仅为FEM细网格求解的一半。
  - 误差随载荷步累积，但最大L²位移误差仍低于1%。

### 不同的硬化模型

| 模型类型       | 缩写 | 物理机制                                                                 | 公式                              |
|----------------|------|--------------------------------------------------------------------------|-----------------------------------|
| **各向同性硬化** | Iso  | 屈服面大小随塑性变形扩展，硬化仅依赖等效塑性应变。                       | `σ_y(ēᵖ) = σ_y0 + H·ēᵖ`          |
| **运动硬化**    | Kine | 屈服面中心在应力空间中平移（背应力演化），硬化由背应力张量描述（Ziegler模型）。 | `q_{i+1} = q_i + (2/3)CΔγ·Z_{i+1}` |

---

## 模型训练预测

1.三个案例所需的数据均已放在对应的`Example`文件夹下：

```
Example1/
├── Shear.inp                    # Abaqus输入文件，定义矩形板周期性剪切问题的有限元模型
├── shear10_iso_Abaqus.npy       # 各向同性硬化（Isotropic）模型的Abaqus仿真结果，表现弹塑性滞回行为
├── shear10_kine_Abaqus.npy      # 运动硬化（Kinematic）模型的Abaqus仿真结果，考虑背应力演化
├── shearWave_iso_Abaqus.npy     # 各向同性硬化剪切波响应的Abaqus仿真结果
└── ShearWave_kine_Abaqus.npy    # 运动硬化剪切波响应的Abaqus仿真结果

Example2/
├── BiMat_Abaqus.npy             # 双材料板剪切行为的Abaqus仿真结果
└── BiMat.inp                   # Abaqus输入文件，构建异质双材料板有限元模型

Example3/
├── Hole_Abaqus.npy              # 3D标准带孔板的Abaqus仿真结果
└── Hole.inp                    # 带孔板标准Abaqus输入文件

注：如果不加kine后缀默认都为各向同性硬化的结果

```

2.使用如下命令可以开启训练`--example`参数可以选择训练的案例，默认为Example1

```bash
python Plasticity_DEM_Train.py --example=1

```
3.使用如下命令可以开启推理`--example`参数可以选择训练的案例，默认为Example1

```bash
python Plasticity_DEM_Inference.py --example=1

```
训练和推理完成后都会在result文件夹下生成vtk文件，可以放入Paraview中进行可视化处理


## 参考

[A deep learning energy-based method for classical elastoplasticity](https://doi.org/10.1016/j.ijplas.2023.103531)

https://github.com/Jasiuk-Research-Group/DEM_for_J2_plasticity/tree/main